(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{318:function(t,s,a){"use strict";a.r(s);var n=a(8),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("custom-header"),t._v(" "),s("h2",{attrs:{id:"script"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#script"}},[t._v("#")]),t._v(" script")]),t._v(" "),s("p",[t._v("当浏览器加载"),s("code",[t._v("html")]),t._v("中遇到"),s("code",[t._v("script")]),t._v("标签，它就无法继续构建"),s("code",[t._v("DOM")]),t._v("。它必须立即执行脚本。浏览器必须要等待脚本下载，执行下载的脚本，然后才能处理页面的其余部分。")]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("存在的问题")]),t._v(" "),s("p",[t._v("如果页面中存在一个庞大的脚本，它就会"),s("code",[t._v("阻塞")]),t._v("页面的加载。在下载和运行完成之前，用于无法看到页面的内容。")]),t._v(" "),s("p",[t._v("解决办法：")]),t._v(" "),s("ul",[s("li",[t._v("把脚本放到最底部，但是也会存在一个问题（对于长的html文档，就有可能有明显的延迟）")])])]),t._v(" "),s("h2",{attrs:{id:"defer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#defer"}},[t._v("#")]),t._v(" defer")]),t._v(" "),s("p",[s("code",[t._v("defer")]),t._v("属性会通知浏览器不需要等待脚本，浏览继续处理构建"),s("code",[t._v("DOM")]),t._v("，该脚本在后台加载，等待DOM构建完成了，再来运行脚本。")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("xxxxx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("执行时机")]),t._v(" "),s("p",[s("code",[t._v("defer")]),t._v("脚本总是在DOM准备好的时机执行，在"),s("code",[t._v("DOMContentLoaded")]),t._v("事件之前。")])]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\tdocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOMContentLoaded'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOM全部加载完成了， defer脚本也执行完成了'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("defer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("defer.js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}}),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n// 假如defer.js的代码是console.log('我是带有defer的脚本')\n\n// 打印结果\n我是带有defer的脚本\nDOM全部加载完成了， defer脚本也执行完成了\n")])])]),s("h3",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("ol",[s("li",[t._v("页面可以立刻显示")]),t._v(" "),s("li",[s("code",[t._v("DOMContentLoaded")]),t._v("事件要等待defer脚本执行完之后执行")])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("HTML5规范要求脚本按照它们出现的先后顺序执行，因此第一个延迟脚本会先于第二个延迟脚本执行，而这两个脚本会先于"),s("code",[t._v("DOMContentLoaded")]),t._v("事件执行。"),s("strong",[t._v("在现实当中")]),t._v("，延迟脚本并不一定会按照顺序执行，也不一定会在"),s("code",[t._v("DOMContentLoad")]),t._v("时间触发前执行，因此最好只包含一个延迟脚本。")])]),t._v(" "),s("h2",{attrs:{id:"async"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#async"}},[t._v("#")]),t._v(" async")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("浏览器不会阻止async脚本")])]),t._v(" "),s("li",[s("p",[t._v("其他脚本也不会等待async脚本，async脚本也不会等待其他脚本")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("DOMContentLoaded")]),t._v("和async脚本不会互相等待")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("DOMContentLoaded")]),t._v("可能在async脚本执行之前触发（如果async脚本在页面解析完成后完成加载；或在async脚本执行之后触发（如果async脚本很快加载完成或在"),s("code",[t._v("HTTP")]),t._v("缓存中）")])])])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("注意")]),t._v(" "),s("p",[t._v("async和defer属性都仅适用于"),s("code",[t._v("外部脚本")]),t._v("，如果script标签没有src属性，尽管写了async、defer属性也会被忽略；")])]),t._v(" "),s("h2",{attrs:{id:"两者区别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#两者区别"}},[t._v("#")]),t._v(" 两者区别")]),t._v(" "),s("p",[t._v("defer 和 async有一个共同点：下载此类脚本都不会阻止页面呈现（异步加载），区别在于：")]),t._v(" "),s("ol",[s("li",[t._v("async 执行与文档顺序无关，先加载哪个就先执行哪个；defer会按照文档中的顺序执行")]),t._v(" "),s("li",[t._v("async 脚本加载完成后立即执行，可以在DOM尚未完全下载完成就加载和执行；而defer脚本需要等到文档所有元素解析完成之后才执行")])])],1)}),[],!1,null,null,null);s.default=e.exports}}]);